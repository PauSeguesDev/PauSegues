---
interface Props {
    linksTexts: string[]
    linksHref: string[] 
}

const { linksTexts, linksHref } = Astro.props;

import HamburgerButton from "@/components/buttons/hamburgerButton.astro";
---

<header class="bg-web-dark-blue sticky top-0 z-100">
    <div class="px-4 sm:px-12 md:px-24 lg:px-64 py-4">
        <nav>
            <div class="flex justify-between items-center">
                <!-- Brand -->
                <div>
                    <a href={linksHref[0]} class="text-2xl font-bold">
                        <img src="/images/logo.webp" alt="" class="w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 hover:scale-110 transition-all duration-300 ease-out">
                    </a>
                </div>

                <!-- Menú desktop -->
                <div class="hidden md:flex items-center space-x-6">
                    <ul class="flex flex-row space-x-8 [&>li]:hover:scale-110 [&>li]:text-xl [&>li]:hover:underline [&>li]:transition-all [&>li]:duration-300 [&>li]:ease-out">
                        {
                            linksTexts.map((text, i) => (
                                <li><a href={linksHref[i]}>{text}</a></li>
                            ))
                        }
                    </ul>

                    <!-- Select de idioma -->
                    <select id="language-select" class="bg-web-dark-blue text-white border-2 rounded-lg px-4 py-2 cursor-pointer appearance-none focus:outline-none">
                        <option value="/">CAT</option>
                        <option value="/es/">ES</option>
                        <option value="/en/">EN</option>
                    </select>

                </div>

                <!-- Mobile Button -->
                <div class="md:hidden">
                    <HamburgerButton id="menu-btn"/>
                </div>
            </div>

            <!-- Menú móvil -->
            <div id="mobile-menu" class="hidden md:hidden mt-2">
                <ul class="flex flex-col space-y-6 [&>li]:text-xl [&>li]:hover:underline [&>li]:transition-all [&>li]:duration-300 [&>li]:ease-out">
                        {
                            linksTexts.map((text, i) => (
                                <li><a href={linksHref[i]}>{text}</a></li>
                            ))
                        }
                    <li>
                        <select id="mobile-language-select" class="bg-web-dark-blue text-white border-2 rounded-lg px-4 py-2 cursor-pointer appearance-none focus:outline-none">
                            <option value="/">CAT</option>
                            <option value="/es/">ES</option>
                            <option value="/en/">EN</option>
                        </select>
                    </li>
                </ul>
            </div>
        </nav>
    </div>
</header>

<script type="module">
    const btn = document.getElementById('menu-btn');
    const menu = document.getElementById('mobile-menu');

    if(btn && menu){
        const spans = btn.querySelectorAll('span');
        btn.addEventListener('click', () => {
            menu.classList.toggle('hidden');
        });
    }

    // Función de idioma
    function setupLanguageSelect(selectId) {
        const select = document.getElementById(selectId);
        if (!select) return;

        // Detectem l'idioma actual segons la URL
        const path = window.location.pathname;
        let currentLang = '/';
        if (path.startsWith('/es/')) currentLang = '/es/';
        else if (path.startsWith('/en/')) currentLang = '/en/';
        select.value = currentLang;

        select.addEventListener('change', () => {
            const newLang = select.value;
            // Substituïm el prefix si ja existeix
            let newPath = path;
            if (currentLang !== '/') {
                newPath = path.replace(currentLang, newLang);
            } else {
                newPath = newLang + path.slice(1); // afegim el nou prefix
            }
            window.location.href = newPath;
        });
    }

    setupLanguageSelect('language-select');
    setupLanguageSelect('mobile-language-select');
</script>
